---
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import InteractiveBlurElement from "../components/InteractiveBlurElement.astro";

export interface Props {
  title?: string;
  desc?: string;
}

import "../styles/global.scss";
import "../styles/styles.scss";

const NODE_ENV = process.env.NODE_ENV;

const { title, desc } = Astro.props as Props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <!-- <link rel="icon" type="image/svg+xml" href="/favicon.svg" /> -->
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
    <meta name="description" content={desc} />

    <!-- 
    Start of global snippet: Please do not remove
    Place this snippet between the <head> and </head> tags on every page of your site.
    Creation date: 08/15/2023
    -->
    <script
      is:inline
      async
      src="https://www.googletagmanager.com/gtag/js?id=DC-9025941"></script>
    <script is:inline>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "DC-9025941");

      /* Event snippet for FR~Page Load_MIN~MOE_SB~SSG_PC~NMCFY23LandingPage on https://www.skillsfuture.gov.sg/upskill: Please do not remove.
      Place this snippet on pages with events youâ€™re tracking. 
      Creation date: 08/15/2023 */
      gtag("event", "conversion", {
        allow_custom_scripts: true,
        send_to: "DC-9025941/ssg/frpag00c+standard",
      });
    </script>

    <!-- STAGING:aa_tracking -->
    {
      NODE_ENV == "production" && (
        <script
          is:inline
          src="//assets.adobedtm.com/7354f1c0c20b/4d66c2785df1/launch-73048e175078.min.js"
        />
      )
    }
    {
      NODE_ENV == "staging" && (
        <script
          is:inline
          src="//assets.adobedtm.com/7354f1c0c20b/4d66c2785df1/launch-1be7209a7910-staging.min.js"
        />
      )
    }
  </head>

  <body>
    <noscript>
      <img
        src="https://ad.doubleclick.net/ddm/activity/src=9025941;type=ssg;cat=frpag00c;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?"
        width="1"
        height="1"
        alt=""
      />
    </noscript>

    <InteractiveBlurElement />

    <Header />

    <main>
      <slot />
    </main>

    <Footer />

    <script>
      import * as bootstrap from "bootstrap";
      console.log("BS", bootstrap);

      import AOS from "aos";
      AOS.init();
      console.log("AOS", AOS);
    </script>

{
  (NODE_ENV == "production" || NODE_ENV == "staging") && (
  <script is:inline>
      // _satellite_tracking
      var digitalData = {
        video: {},
        email: {},
      };

      // newsletter-track.js.
      function trackUpskillNewsLetter(email) {
        if (validateEmail(email)) {
          digitalData.email.address = email;
          _satellite.track("upskillNewsletter");
        }
      }
      // yt-track.js.
      function trackVideoView(videoTitle) {
        digitalData.video.title = videoTitle;
        _satellite.track("videoView");
      }

      function validateEmail(email) {
        return String(email)
          .toLowerCase()
          .match(
            /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
          );
      }
      _satellite.pageBottom();
    </script>
  )
}
  </body>
</html>
